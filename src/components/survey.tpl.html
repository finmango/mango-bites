<div id="mango-bites-survey">
    <style>
    .animated {
        transition: all 500ms ease-in-out;
    }

    .screen {
        height: 0;
        opacity: 0;
        overflow: hidden;
        max-width: 600px;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    .screen-visible {
        height: auto;
        opacity: 1;
        overflow: initial;
    }
    .mangos{
        position: relative;
    }

    /*Animations: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations/Using_CSS_animations*/
    p {
        animation-duration: 2.75s;
        animation-name: slidein;
        animation-iteration-count: 1;
    }
    @keyframes slidein {
        from {
            margin-left: 100%;
            width: 300%;
        }

        to {
            margin-left: 0%;
            width: 100%;
        }
    }
    </style>

    <div class="screen animated">
        <h2 class="centered" style="text-transform: none; font-size: xx-large; margin-left: 10%; margin-right: 10%; margin-top: 20px; margin-bottom: 20px;">
            Touch the mango to take a bite!
        </h2>
    </div>

    <div class="mangos">
        <img
            src="{{root}}/static/mango.svg"
            id = "mango"
            alt="mango svg"
            height="170"
            width="180"
            class= "centered" 
            style="width: 50%; display: block"/>
        <img
            src="{{root}}/static/mango_bite1.svg"
            id = "mango-bite-1"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite2.svg"
            id = "mango-bite-2"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite3.svg"
            id = "mango-bite-3"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite4.svg"
            id = "mango-bite-4"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite5.svg"
            id = "mango-bite-5"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite6.svg"
            id = "mango-bite-6"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite7.svg"
            id = "mango-bite-7"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
        <img
            src="{{root}}/static/mango_bite8.svg"
            id = "mango-bite-8"
            alt="mango bite svg"
            height="170"
            width="180"
            class= "centered"
            style="width: 50%; display: none" />
    </div>

    <div class="fun-fact">
        <h2 class="centered">
            <p id="fun-fact" style="font-size: x-large; margin-left: 3%; margin-right: 3%; text-align: left;"> </p>
            <span id="fun-fact" style="font-size: large; margin-left: 3%; margin-right: 3%; text-align: left;"></span>
        </h2> 
    </div>

    <script async>
        (async function () {
            const rootElement = document.currentScript.parentElement;
            let screenIdx = 0;
            const screens = [].slice.call(rootElement.querySelectorAll('div.screen'), 0, -1);
            rootElement.querySelector('div.screen:first-of-type').classList.add('screen-visible'); 

            // MAKE MANGO TAKE A RANDOM BITE FROM ALL MANGO SVGS THEN GO BACK ON CLICK 

            let arr = ['mango-bite-1','mango-bite-2','mango-bite-3','mango-bite-4','mango-bite-5','mango-bite-6','mango-bite-7','mango-bite-8'];
            
            rootElement.querySelector('#mango').addEventListener('click', event => {
                document.getElementById('mango').style.display = "none";
                console.log('test randomness: ' + arr[Math.floor(Math.random() * arr.length)]);
                var random_mango = document.getElementById(arr[Math.floor(Math.random() * arr.length)]).style.display = "block";
                random_mango;  
                
                // GET RANDOM MANGO BITE FUN FACT FROM DATA.JSON  
                fetch('{{root}}/static/data3.json')
                .then(response => {
                return response.json();
                })
                .then(data3 => {
                    console.log(data3);
                    const randomFact = data3[Math.floor(Math.random() * data3.length)];
                    console.log(randomFact['fact']);
                    rootElement.querySelector('#fun-fact').innerText = ' Did you know that ' + randomFact['fact'];
                });

                setTimeout(function() {
                    document.getElementById('mango').style.display = "block";
                    document.getElementById(random_mango).style.display = "none";
                    //console.log('hi mango bite');
                }, 500);
                });

        })();

    </script>

</div>